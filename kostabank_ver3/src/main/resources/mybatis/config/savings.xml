<?xml version="1.0" encoding="UTF-8"?>
<!-- Sql Mapper -->
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="savings">
<select id="savingsProductlist" resultType="accountTypeVO">
	select accountName from kangbank_account_type where accountType=#{value} order by accountName asc
</select>
	<resultMap type="accountRatesVO" id="accountTypeRM">
		<result property="accountTypeVO.accountExplanation" column="accountExplanation" />
		<result property="accountTypeVO.minMoney" column="minMoney" />
		<result property="accountTypeVO.accountType" column="accountType" />
		<result property="accountTypeVO.accountName" column="accountName" />
	</resultMap>
<select id = "accountNameFindAccountList" resultType="accountRatesVO" resultMap="accountTypeRM">
select a.accountName,a.accountType,a.minMoney,a.accountExplanation,r.accountSeq,r.rates,r.term
from (select accountName,rates,term,accountSeq 
	  from kangbank_account_rates 
	  order by ratesMonth desc ) r,
	  		 kangbank_account_type a ,
  	  (select max(rates) as rates
 	  from kangbank_account_rates 
 	  where accountName =#{value}) b
where a.accountName=r.accountName and a.accountName=#{value} and r.rates = b.rates
</select>
<select id="getRatesByTerm" resultType="double" >
select rates from kangbank_account_rates
where accountSeq=#{accountSeq}
</select>   
 <insert id="createSavings" parameterType="savingsVO">
insert into kangbank_savings(accountNo, automaticNo, accountSeq, monthlyPayment, paybackNo)
values (#{accountVO.accountNo},#{automaticNo},#{accountRatesVO.accountSeq},#{monthlyPayment},#{paybackNo})
</insert> 

<select id="findRatesSeq" parameterType="accountRatesVO" resultType="int">
select accountSeq from kangbank_account_rates where rates=#{rates} and term=#{term}
</select>

<select id="accountSeqByName" resultType="accountRatesVO">
select accountSeq, rates, term
from
(select accountSeq, rates, term, accountName, ratesMonth from KANGBANK_ACCOUNT_RATES) A,
(select accountName, accountType, accountExplanation, minMoney from KANGBANK_ACCOUNT_TYPE) B
where A.accountName=B.accountName and B.accountType='적금' and A.accountName=#{accountName}
</select>
<select id="getTermBySeq" resultType="int">
select term from kangbank_account_rates
where accountSeq=#{accountSeq}
</select>
</mapper>

